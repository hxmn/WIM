DROP VIEW PPDM.WELL_TEST_ANALYSIS;

/* Formatted on 4/2/2013 11:40:57 AM (QP5 v5.185.11230.41888) */
CREATE OR REPLACE FORCE VIEW PPDM.WELL_TEST_ANALYSIS
(
   UWI,
   SOURCE,
   TEST_TYPE,
   RUN_NUM,
   TEST_NUM,
   PERIOD_TYPE,
   PERIOD_OBS_NO,
   ANALYSIS_OBS_NO,
   ACTIVE_IND,
   BSW,
   COMPLETION_OBS_NO,
   CONDENSATE_GRAVITY,
   CONDENSATE_RATIO,
   CONDENSATE_RATIO_OUOM,
   CONDENSATE_TEMPERATURE,
   CONDENSATE_TEMPERATURE_OUOM,
   EFFECTIVE_DATE,
   EXPIRY_DATE,
   FLUID_TYPE,
   GAS_CONTENT,
   GAS_GRAVITY,
   GOR,
   GOR_OUOM,
   GWR,
   GWR_OUOM,
   H2S_PERCENT,
   LGR,
   LGR_OUOM,
   OIL_DENSITY,
   OIL_DENSITY_OUOM,
   OIL_GRAVITY,
   OIL_TEMPERATURE,
   OIL_TEMPERATURE_OUOM,
   PPDM_GUID,
   REMARK,
   SALINITY_TYPE,
   SULPHUR_PERCENT,
   WATER_CUT,
   WATER_RESISTIVITY,
   WATER_RESISTIVITY_OUOM,
   WATER_SALINITY,
   WATER_SALINITY_OUOM,
   WATER_TEMPERATURE,
   WATER_TEMPERATURE_OUOM,
   WOR,
   ROW_CHANGED_BY,
   ROW_CHANGED_DATE,
   ROW_CREATED_BY,
   ROW_CREATED_DATE,
   ROW_QUALITY,
   PROVINCE_STATE
)
AS
   SELECT UWI,
          SOURCE,
          TEST_TYPE,
          RUN_NUM,
          TEST_NUM,
          PERIOD_TYPE,
          PERIOD_OBS_NO,
          ANALYSIS_OBS_NO,
          ACTIVE_IND,
          BSW,
          COMPLETION_OBS_NO,
          CONDENSATE_GRAVITY,
          CONDENSATE_RATIO,
          CONDENSATE_RATIO_OUOM,
          CONDENSATE_TEMPERATURE,
          CONDENSATE_TEMPERATURE_OUOM,
          EFFECTIVE_DATE,
          EXPIRY_DATE,
          FLUID_TYPE,
          GAS_CONTENT,
          GAS_GRAVITY,
          GOR,
          GOR_OUOM,
          GWR,
          GWR_OUOM,
          H2S_PERCENT,
          LGR,
          LGR_OUOM,
          OIL_DENSITY,
          OIL_DENSITY_OUOM,
          OIL_GRAVITY,
          OIL_TEMPERATURE,
          OIL_TEMPERATURE_OUOM,
          PPDM_GUID,
          REMARK,
          SALINITY_TYPE,
          SULPHUR_PERCENT,
          WATER_CUT,
          WATER_RESISTIVITY,
          WATER_RESISTIVITY_OUOM,
          WATER_SALINITY,
          WATER_SALINITY_OUOM,
          WATER_TEMPERATURE,
          WATER_TEMPERATURE_OUOM,
          WOR,
          ROW_CHANGED_BY,
          ROW_CHANGED_DATE,
          ROW_CREATED_BY,
          ROW_CREATED_DATE,
          ROW_QUALITY,
          -- IHS extensions
          NULL AS PROVINCE_STATE
     FROM tlm_well_TEST_analysis
   UNION ALL
   SELECT UWI,
          SOURCE,
          TEST_TYPE,
          RUN_NUM,
          TEST_NUM,
          PERIOD_TYPE,
          PERIOD_OBS_NO,
          ANALYSIS_OBS_NO,
          ACTIVE_IND,
          BSW,
          COMPLETION_OBS_NO,
          CONDENSATE_GRAVITY,
          CONDENSATE_RATIO,
          CONDENSATE_RATIO_OUOM,
          CONDENSATE_TEMPERATURE,
          CONDENSATE_TEMPERATURE_OUOM,
          EFFECTIVE_DATE,
          EXPIRY_DATE,
          FLUID_TYPE,
          GAS_CONTENT,
          GAS_GRAVITY,
          GOR,
          GOR_OUOM,
          GWR,
          GWR_OUOM,
          H2S_PERCENT,
          LGR,
          LGR_OUOM,
          OIL_DENSITY,
          OIL_DENSITY_OUOM,
          OIL_GRAVITY,
          OIL_TEMPERATURE,
          OIL_TEMPERATURE_OUOM,
          PPDM_GUID,
          REMARK,
          SALINITY_TYPE,
          SULPHUR_PERCENT,
          WATER_CUT,
          WATER_RESISTIVITY,
          WATER_RESISTIVITY_OUOM,
          WATER_SALINITY,
          WATER_SALINITY_OUOM,
          WATER_TEMPERATURE,
          WATER_TEMPERATURE_OUOM,
          WOR,
          ROW_CHANGED_BY,
          ROW_CHANGED_DATE,
          ROW_CREATED_BY,
          ROW_CREATED_DATE,
          ROW_QUALITY,
          -- IHS extensions
          PROVINCE_STATE
     FROM IHS_CDN_WELL_TEST_ANALYSIS
   UNION ALL
   SELECT UWI,
          SOURCE,
          TEST_TYPE,
          RUN_NUM,
          TEST_NUM,
          PERIOD_TYPE,
          PERIOD_OBS_NO,
          ANALYSIS_OBS_NO,
          ACTIVE_IND,
          BSW,
          COMPLETION_OBS_NO,
          CONDENSATE_GRAVITY,
          CONDENSATE_RATIO,
          CONDENSATE_RATIO_OUOM,
          CONDENSATE_TEMPERATURE,
          CONDENSATE_TEMPERATURE_OUOM,
          EFFECTIVE_DATE,
          EXPIRY_DATE,
          FLUID_TYPE,
          GAS_CONTENT,
          GAS_GRAVITY,
          GOR,
          GOR_OUOM,
          GWR,
          GWR_OUOM,
          H2S_PERCENT,
          LGR,
          LGR_OUOM,
          OIL_DENSITY,
          OIL_DENSITY_OUOM,
          OIL_GRAVITY,
          OIL_TEMPERATURE,
          OIL_TEMPERATURE_OUOM,
          PPDM_GUID,
          REMARK,
          SALINITY_TYPE,
          SULPHUR_PERCENT,
          WATER_CUT,
          WATER_RESISTIVITY,
          WATER_RESISTIVITY_OUOM,
          WATER_SALINITY,
          WATER_SALINITY_OUOM,
          WATER_TEMPERATURE,
          WATER_TEMPERATURE_OUOM,
          WOR,
          ROW_CHANGED_BY,
          ROW_CHANGED_DATE,
          ROW_CREATED_BY,
          ROW_CREATED_DATE,
          ROW_QUALITY,
          -- IHS extensions
          PROVINCE_STATE
     FROM IHS_US_WELL_TEST_ANALYSIS;


DROP SYNONYM DATA_FINDER.WELL_TEST_ANALYSIS;
CREATE OR REPLACE SYNONYM DATA_FINDER.WELL_TEST_ANALYSIS FOR PPDM.WELL_TEST_ANALYSIS;


DROP SYNONYM EDIOS_ADMIN.WELL_TEST_ANALYSIS;
CREATE OR REPLACE SYNONYM EDIOS_ADMIN.WELL_TEST_ANALYSIS FOR PPDM.WELL_TEST_ANALYSIS;


DROP SYNONYM PPDM.WTA;
CREATE OR REPLACE SYNONYM PPDM.WTA FOR PPDM.WELL_TEST_ANALYSIS;


GRANT SELECT ON PPDM.WELL_TEST_ANALYSIS TO PPDM_RO;
